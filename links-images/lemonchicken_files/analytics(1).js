(()=>{var e={78:e=>{e.exports=function(){return this.dom}()}},t={};function i(n){var r=t[n];if(void 0!==r)return r.exports;var o=t[n]={exports:{}};return e[n](o,o.exports,i),o.exports}i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n={};(()=>{"use strict";i.r(n),i.d(n,{default:()=>h});var e=i(78),t=i.n(e);function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function o(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,s(n.key),n)}}function s(e){var t=function(e,t){if("object"!=r(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==r(t)?t:t+""}var c=("e.chicoryapp.com".includes("localhost")?"http://":"https://")+"e.chicoryapp.com",a=new Date((new Date).toUTCString()).getTime(),l=["view_button","referred_view_button","click_button","referred_click_button","choose_grocer","click_campaign","referred_modal_view"],u=["ad_injected","view_button","click_button","referred_click_button","referred_view_button","view_campaign","click_campaign","click_print_button","choose_grocer","referred_choose_grocer","click_send_to_grocer","deactivate_ingredient","activate_ingredient","view_cart","view_product_alternates","choose_product_alternate","close_cart","c2c_login_prompt","c2c_login_send","c2c_login_successful","c2c_login_failed","partner_link","choose_grocer_location","ra_grocer_redirect","referred_ra_grocer_redirect","ctc_login_attempted","ra_login_attempted","buy_button_click","click_to_cart","sslp_page_view","sslp_choose_retailer","sslp_choose_location","sslp_retailer_scroll","sslp_retailer_redirect","sslp_choose_client_link","referred_modal_view","modal_back_button_clicked","open_modal","close_modal","view_aisle","view_sponsored_retailer_ad","view_product_tile","click_product_tile","view_product_tile_ad","click_product_tile_ad","change_aisle_retailer","change_aisle_slide","print_ad_view","print_ra_view","print_ra_scan","aisle_no_ads_deactivate","premium_pairing_slot_forfeit"],d=["view_button","click_button","referred_view_button","referred_click_button","choose_grocer","referred_choose_grocer","choose_grocer_location","ra_grocer_redirect","referred_ra_grocer_redirect","ra_login_attempted","close_cart","modal_back_button_clicked","print_ra_view","print_ra_scan"],_=["sslp_page_view","ra_choose_grocer","referred_ra_choose_grocer","ra_choose_location","sslp_choose_retailer","sslp_choose_client_link","sslp_choose_location","sslp_retailer_redirect","sslp_retailer_scroll","ra_grocer_redirect","referred_ra_grocer_redirect","click_to_cart"];const h=new(function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.settings={},this.device={},this.session={},this.funnel={},this.queue=[],this.$iframe=null,this.ready=!1,this.listen=t().listen,this.send_event=t().send},i=[{key:"deactivate",value:function(){}},{key:"activate",value:function(e){return this.load(e).then(this.run.bind(this)).catch(t().done),this}},{key:"load",value:function(e){var i=this;return new Promise(function(n){if(this.settings=e,this.setSessionProperties({is_mobile:e.is_mobile}),this.setFunnelProperties({recipe_id:e.recipe?e.recipe.id:null}),this.ready)return n();var r=document.createElement("template");r.innerHTML='<iframe id="chicory-analytics" src="'+c+"/api/init"+(e.new_funnel?"#funnel":"")+'"  style="display: none;width: 0px;height: 0px;">',this.$iframe=r.content.firstChild,document.body.appendChild(this.$iframe),this.wait(this.$iframe,"init").then(function(e){this.device=e.device,this.session=e.session,this.funnel=e.funnel,this.ready=!0,t().each(this.queue,function(e,i){var n=this[i.method],r=i.args,o=i.promise;n.apply(this,r).then((function(e){o.resolve(e)})).catch(t().done),delete this.queue[e]}.bind(this)),t().each(u,function(e,i){t().listen(i,function(e){this.logEvent(i,e),l.includes(i)&&this.broadcastEvent(i,e,this.settings.recipe)}.bind(this))}.bind(this)),t().listen("getEvent",(function(e){var n=i.getEvent(e.name,e);t().send("getEvent",n)})),t()(".ERSPrintBtn, .wpurp-recipe-print-button, .zlrecipe-print-link, .yrecipe-print-link .blog-yumprint-print").on("click",(function(){t().send("click_print_button")})),n()}.bind(this)).catch(t().done)}.bind(this))}},{key:"run",value:function(){}},{key:"toggleTracking",value:function(){return this.ready?(this.device.disable_tracking=!this.device.disable_tracking,this.send(this.$iframe,"saveDevice",this.device)):this.delay("toggleTracking",arguments)}},{key:"setDeviceProperties",value:function(e){return this.ready?(t().extend(this.device.properties,e),this.send(this.$iframe,"saveDevice",this.device)):this.delay("setDeviceProperties",arguments)}},{key:"setSessionProperties",value:function(e){return this.ready?(t().extend(this.session.properties,e),this.send(this.$iframe,"saveSession",this.session)):this.delay("setSessionProperties",arguments)}},{key:"setFunnelProperties",value:function(e){return this.ready?(t().extend(this.funnel.properties,e),this.send(this.$iframe,"saveFunnel",this.funnel)):this.delay("setFunnelProperties",arguments)}},{key:"logEvent",value:function(e,t){if(!this.ready)return this.delay("logEvent",arguments);var i=this.getEvent(e,t);return this.send(this.$iframe,"logEvent",i)}},{key:"broadcastEvent",value:function(e,i,n){if(!this.ready)return this.delay("broadcastEvent",arguments);var r=i.grocer?i.grocer.name:null,o=n?this.parseRecipeData(n):null,s={event_name:e};return r&&(s.retailer=r),this.broadcast(e,t().extend(s,o))}},{key:"parseRecipeData",value:function(e){return{recipe_name:e.name,recipe_url:e.source_uri,ingredients:e.ingredient_lines.map((function(e){return e.ingredient}))}}},{key:"getEvent",value:function(e,i){i.referrer&&delete i.referrer;var n=new Date((new Date).toUTCString()).getTime();if(d.includes(e)){var r=i?i.unique_identifier:null;r&&(this.unique_identifier=r),this.unique_identifier&&(i.unique_identifier=this.unique_identifier)}var o=null;return i&&i.funnel_id&&(o=(i=JSON.parse(JSON.stringify(i))).funnel_id,delete i.funnel_id),{uuid:this.device.uuid,session_id:this.session.id,funnel_id:o||this.getCurrentFunnel(e),name:e,recipe_id:this.funnel.properties.recipe_id||i.recipe_id,viewport_height:t()(window.document).height(),viewport_width:t()(window.document).width(),language:window.navigator.language||navigator.userLanguage,encoding:window.document.characterSet||window.document.defaultCharset,url:window.document.location.href,referrer:window.document.referrer,duration:n-(window.performance?window.performance.timing.domContentLoadedEventEnd:a),client_timestamp:n,properties:t().extend({},this.device.properties,this.session.properties,this.funnel.properties,i||{})}}},{key:"delay",value:function(e,t){var i,n=new Promise((function(e){i=e}));return this.queue.push({method:e,args:t,promise:{resolve:i}}),n}},{key:"send",value:function(e,i,n){return new Promise(function(r){this.wait(e,i).then((function(e){r(e)})).catch(t().done),e.contentWindow.postMessage({call:i,args:n},c)}.bind(this))}},{key:"broadcast",value:function(e,t){return new Promise(function(e){window.dispatchEvent(new CustomEvent("chicoryevent",{detail:t})),e()}.bind(this))}},{key:"wait",value:function(e,t){return new Promise(function(i){window.addEventListener("message",(function n(r){var o=new RegExp(c.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1"),"g");if(r.origin.match(o)&&r.source===e.contentWindow){var s=JSON.parse(r.data);s.caller===t&&(window.removeEventListener("message",n),i(s.data))}}),!1)}.bind(this))}},{key:"setFunnel",value:function(e){return e&&(this.funnel.id=e,this.send(this.$iframe,"saveFunnel",this.funnel)),this.send(this.$iframe,"saveFunnel",this.funnel)}},{key:"getCurrentFunnel",value:function(e){return _.includes(e)&&this.device.last_clicked_funnel_id?this.device.last_clicked_funnel_id:this.funnel.id}}],i&&o(e.prototype,i),n&&o(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,i,n}())})(),(this.Chicory=this.Chicory||{}).analytics=n})();